 FAIL  tests/integration/api/translation-websocket.test.ts > WebSocket Translation Integration > should process streaming audio message via WebSocket
AssertionError: expected "spy" to be called at least once
 ❯ tests/integration/api/translation-websocket.test.ts:147:24
    145|     
    146|     // Verify results were sent back via the websocket
    147|     expect(messageSpy).toHaveBeenCalled();
       |                        ^
    148|     const messageData = JSON.parse(messageSpy.mock.calls[0][0]);
    149|     expect(messageData.type).toBe('transcription');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/5]⎯

 FAIL  tests/integration/api/translation-websocket.test.ts > WebSocket Translation Integration > should finalize a streaming session via WebSocket
AssertionError: expected "spy" to be called at least once
 ❯ tests/integration/api/translation-websocket.test.ts:172:24
    170|     
    171|     // Verify results were sent back via the websocket
    172|     expect(messageSpy).toHaveBeenCalled();
       |                        ^
    173|     const messageData = JSON.parse(messageSpy.mock.calls[0][0]);
    174|     expect(messageData.type).toBe('finalize');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/5]⎯

 FAIL  tests/integration/api/translation-websocket.test.ts > WebSocket Translation Integration > should handle complete audio streaming and translation workflow
AssertionError: expected +0 to be 3 // Object.is equality

- Expected
+ Received

- 3
+ 0

 ❯ tests/integration/api/translation-websocket.test.ts:211:35
    209|     
    210|     // Verify the complete workflow produced the expected results
    211|     expect(messageResults.length).toBe(3);
       |                                   ^
    212|     
    213|     // First message should be transcription for chunk 1

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/5]⎯

 FAIL  tests/integration/api/translation-websocket.test.ts > WebSocket Translation Integration > should test error handling in the websocket translation flow
AssertionError: expected "error" to be called at least once
 ❯ tests/integration/api/translation-websocket.test.ts:256:31
    254|     } catch (error) {
    255|       // Error should be caught and logged
    256|       expect(consoleErrorSpy).toHaveBeenCalled();
       |                               ^
    257|     }
    258|     

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/5]⎯

 FAIL  tests/integration/services/streaming-transcription.test.ts > Streaming Transcription Integration > should process streaming audio in chunks
AssertionError: expected 0 to be greater than 0
 ❯ tests/integration/services/streaming-transcription.test.ts:146:41
    144|     // We expect at least one message to be a finalization message
    145|     const finalizationMessages = ws.messages.filter(m => m.type === 'f…
    146|     expect(finalizationMessages.length).toBeGreaterThan(0);
       |                                         ^
    147|     
    148|     if (finalizationMessages.length > 0) {