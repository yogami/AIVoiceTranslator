# Test info

- Name: Teacher-Student End-to-End Flow >> should handle basic teacher-student interaction
- Location: /Users/yamijala/gitprojects/AIVoiceTranslator/tests/e2e/teacher-student-flow.spec.ts:33:3

# Error details

```
Error: Timed out 5000ms waiting for expect(locator).toBeVisible()

Locator: locator('#students-list')
Expected: visible
Received: <element(s) not found>
Call log:
  - expect.toBeVisible with timeout 5000ms
  - waiting for locator('#students-list')

    at /Users/yamijala/gitprojects/AIVoiceTranslator/tests/e2e/teacher-student-flow.spec.ts:70:38
```

# Page snapshot

```yaml
- heading "ðŸŽ“ Teacher Interface" [level=1]
- text: "Classroom Code: LP0GNK Students can join at: http://127.0.0.1:5000/student?code=LP0GNK"
- img
- text: "Your Language:"
- combobox "Your Language:":
  - option "ðŸ‡ºðŸ‡¸ English (United States)" [selected]
  - option "ðŸ‡¬ðŸ‡§ English (United Kingdom)"
  - option "ðŸ‡¦ðŸ‡º English (Australia)"
  - option "ðŸ‡¨ðŸ‡¦ English (Canada)"
  - option "ðŸ‡ªðŸ‡¸ Spanish (Spain)"
  - option "ðŸ‡²ðŸ‡½ Spanish (Mexico)"
  - option "ðŸ‡¦ðŸ‡· Spanish (Argentina)"
  - option "ðŸ‡«ðŸ‡· French (France)"
  - option "ðŸ‡¨ðŸ‡¦ French (Canada)"
  - option "ðŸ‡©ðŸ‡ª German (Germany)"
  - option "ðŸ‡®ðŸ‡¹ Italian (Italy)"
  - option "ðŸ‡µðŸ‡¹ Portuguese (Portugal)"
  - option "ðŸ‡§ðŸ‡· Portuguese (Brazil)"
  - option "ðŸ‡·ðŸ‡º Russian (Russia)"
  - option "ðŸ‡µðŸ‡± Polish (Poland)"
  - option "ðŸ‡³ðŸ‡± Dutch (Netherlands)"
  - option "ðŸ‡¸ðŸ‡ª Swedish (Sweden)"
  - option "ðŸ‡©ðŸ‡° Danish (Denmark)"
  - option "ðŸ‡³ðŸ‡´ Norwegian (Norway)"
  - option "ðŸ‡«ðŸ‡® Finnish (Finland)"
  - option "ðŸ‡®ðŸ‡¸ Icelandic (Iceland)"
  - option "ðŸ‡­ðŸ‡º Hungarian (Hungary)"
  - option "ðŸ‡¨ðŸ‡¿ Czech (Czech Republic)"
  - option "ðŸ‡¸ðŸ‡° Slovak (Slovakia)"
  - option "ðŸ‡¸ðŸ‡® Slovenian (Slovenia)"
  - option "ðŸ‡­ðŸ‡· Croatian (Croatia)"
  - option "ðŸ‡·ðŸ‡¸ Serbian (Serbia)"
  - option "ðŸ‡§ðŸ‡¬ Bulgarian (Bulgaria)"
  - option "ðŸ‡·ðŸ‡´ Romanian (Romania)"
  - option "ðŸ‡¬ðŸ‡· Greek (Greece)"
  - option "ðŸ‡¹ðŸ‡· Turkish (Turkey)"
  - option "ðŸ‡¨ðŸ‡³ Chinese (Simplified)"
  - option "ðŸ‡¹ðŸ‡¼ Chinese (Traditional)"
  - option "ðŸ‡¯ðŸ‡µ Japanese (Japan)"
  - option "ðŸ‡°ðŸ‡· Korean (Korea)"
  - option "ðŸ‡®ðŸ‡³ Hindi (India)"
  - option "ðŸ‡®ðŸ‡³ Bengali (India)"
  - option "ðŸ‡®ðŸ‡³ Tamil (India)"
  - option "ðŸ‡®ðŸ‡³ Telugu (India)"
  - option "ðŸ‡®ðŸ‡³ Marathi (India)"
  - option "ðŸ‡®ðŸ‡³ Gujarati (India)"
  - option "ðŸ‡®ðŸ‡³ Kannada (India)"
  - option "ðŸ‡®ðŸ‡³ Malayalam (India)"
  - option "ðŸ‡®ðŸ‡³ Punjabi (India)"
  - option "ðŸ‡µðŸ‡° Urdu (Pakistan)"
  - option "ðŸ‡¹ðŸ‡­ Thai (Thailand)"
  - option "ðŸ‡»ðŸ‡³ Vietnamese (Vietnam)"
  - option "ðŸ‡®ðŸ‡© Indonesian (Indonesia)"
  - option "ðŸ‡²ðŸ‡¾ Malay (Malaysia)"
  - option "ðŸ‡µðŸ‡­ Filipino (Philippines)"
  - option "ðŸ‡¸ðŸ‡¦ Arabic (Saudi Arabia)"
  - option "ðŸ‡ªðŸ‡¬ Arabic (Egypt)"
  - option "ðŸ‡¦ðŸ‡ª Arabic (UAE)"
  - option "ðŸ‡®ðŸ‡± Hebrew (Israel)"
  - option "ðŸ‡®ðŸ‡· Persian (Iran)"
  - option "ðŸ‡°ðŸ‡ª Swahili (Kenya)"
  - option "ðŸ‡ªðŸ‡¹ Amharic (Ethiopia)"
  - option "ðŸ‡¿ðŸ‡¦ Zulu (South Africa)"
  - option "ðŸ‡¿ðŸ‡¦ Afrikaans (South Africa)"
  - option "ðŸ´ó§ó¢ó·ó¬ó³ó¿ Welsh (Wales)"
  - option "ðŸ‡®ðŸ‡ª Irish (Ireland)"
  - option "ðŸ‡²ðŸ‡¹ Maltese (Malta)"
  - option "ðŸ‡±ðŸ‡» Latvian (Latvia)"
  - option "ðŸ‡±ðŸ‡¹ Lithuanian (Lithuania)"
  - option "ðŸ‡ªðŸ‡ª Estonian (Estonia)"
  - option "ðŸ‡²ðŸ‡° Macedonian (North Macedonia)"
  - option "ðŸ‡¦ðŸ‡± Albanian (Albania)"
  - option "ðŸ´ó§ó¢ó¢ó¡ó³ó¿ Basque (Spain)"
  - option "ðŸ´ó§ó¢ó£ó¡ó´ó¿ Catalan (Spain)"
  - option "ðŸ´ó§ó¢ó§ó¬ó£ó¿ Galician (Spain)"
- button "Start Recording"
- text: "Registered as teacher Live Transcription: Transcribed speech will appear here..."
- 'heading "Connected Students: 0" [level=3]'
- text: No students connected yet
```

# Test source

```ts
   1 | /**
   2 |  * Teacher-Student Flow E2E Test
   3 |  * 
   4 |  * This test verifies the complete end-to-end flow of a teacher
   5 |  * speaking and students receiving translations.
   6 |  */
   7 |
   8 | import { test, expect, Browser, BrowserContext, Page } from '@playwright/test';
   9 |
   10 | test.describe('Teacher-Student End-to-End Flow', () => {
   11 |   let browser: Browser;
   12 |   let teacherContext: BrowserContext;
   13 |   let studentContext: BrowserContext;
   14 |   let teacherPage: Page;
   15 |   let studentPage: Page;
   16 |
   17 |   test.beforeEach(async ({ browser: b }) => {
   18 |     browser = b;
   19 |     // Create separate contexts for teacher and student
   20 |     teacherContext = await browser.newContext();
   21 |     studentContext = await browser.newContext();
   22 |     
   23 |     // Create pages
   24 |     teacherPage = await teacherContext.newPage();
   25 |     studentPage = await studentContext.newPage();
   26 |   });
   27 |
   28 |   test.afterEach(async () => {
   29 |     await teacherContext.close();
   30 |     await studentContext.close();
   31 |   });
   32 |
   33 |   test('should handle basic teacher-student interaction', async () => {
   34 |     // Step 1: Open teacher interface
   35 |     await teacherPage.goto('/teacher');
   36 |     await expect(teacherPage.locator('h1')).toContainText('Teacher Interface');
   37 |     await expect(teacherPage.locator('#status')).toContainText('Registered as teacher', { timeout: 10000 });
   38 |
   39 |     // Extract classroom code from teacher page
   40 |     const classroomCodeElement = teacherPage.locator('#classroom-code-display');
   41 |     await expect(classroomCodeElement).toBeVisible({ timeout: 10000 });
   42 |     const classroomCode = await classroomCodeElement.textContent();
   43 |     expect(classroomCode).not.toBeNull();
   44 |     expect(classroomCode).not.toBe('');
   45 |     console.log(`Extracted classroom code: ${classroomCode}`);
   46 |     
   47 |     // Step 2: Open student interface with the extracted classroom code
   48 |     await studentPage.goto(`/student?code=${classroomCode}`);
   49 |     await expect(studentPage.locator('h1')).toContainText('ðŸŽ§ Student Interface');
   50 |     
   51 |     // Select language for student
   52 |     await studentPage.selectOption('#language-dropdown', 'es-ES');
   53 |     // The connect button might be auto-clicked or enabled by the presence of classroom code.
   54 |     // If it's not auto-connected, click it. Student HTML logic shows it auto-selects first lang and enables connect.
   55 |     // Let's assume student needs to click connect after language selection.
   56 |     await studentPage.click('#connect-btn');
   57 |     await expect(studentPage.locator('#connection-status span')).toContainText('Connected', { timeout: 10000 });
   58 |     
   59 |     // Step 3: Verify states
   60 |     // Verify teacher is ready to record (status might still be "Registered as teacher" or "X students connected" 
   61 |     // if speech recognition setup is quick and no students were there before)
   62 |     // The most reliable state after registration and before explicit recording is 'Registered as teacher' 
   63 |     // or if a student connects, the student list updates.
   64 |     // Let's check for student in list.
   65 |     // First, wait for the "No students connected yet." message to disappear or be hidden.
   66 |     await expect(teacherPage.locator('#student-items-container .no-students')).toBeHidden({ timeout: 10000 });
   67 |     
   68 |     // Then, check for the student item.
   69 |     const studentListLocator = teacherPage.locator('#students-list');
>  70 |     await expect(studentListLocator).toBeVisible({ timeout: 5000 }); // Ensure the list itself is visible
      |                                      ^ Error: Timed out 5000ms waiting for expect(locator).toBeVisible()
   71 |     await expect(studentListLocator).toContainText('(Lang: es-ES)', { timeout: 10000 });
   72 |     
   73 |     await expect(teacherPage.locator('#record-btn')).toBeEnabled(); // Record button should be enabled
   74 |     
   75 |     // Verify student is ready to receive
   76 |     await expect(studentPage.locator('#translation-box')).toBeVisible();
   77 |     const translationBoxText = await studentPage.locator('#translation-box').textContent();
   78 |     expect(translationBoxText).toBeTruthy(); // Should have some placeholder or instruction text
   79 |     // Check for the "Joining Classroom: CODE" info box
   80 |     await expect(studentPage.locator(`text=Joining Classroom: ${classroomCode}`)).toBeVisible();
   81 |   });
   82 |
   83 |   test('should handle student language change', async () => {
   84 |     // Setup teacher
   85 |     await teacherPage.goto('/teacher');
   86 |     await expect(teacherPage.locator('#status')).toContainText('Registered as teacher', { timeout: 10000 });
   87 |     
   88 |     // Setup student
   89 |     await studentPage.goto('/student');
   90 |     await studentPage.selectOption('#language-dropdown', 'fr');
   91 |     await studentPage.click('#connect-btn');
   92 |     await expect(studentPage.locator('#connection-status span')).toContainText('Connected', { timeout: 10000 });
   93 |     
   94 |     // Change language while connected
   95 |     await studentPage.selectOption('#language-dropdown', 'de');
   96 |     // Add assertion to check if re-registration occurs or status updates if applicable
   97 |     // For now, just ensure it doesn't break and student is still connected
   98 |     await expect(studentPage.locator('#connection-status span')).toContainText('Connected', { timeout: 10000 });
   99 |     // Check teacher still sees student, perhaps with updated language if UI supports it
  100 |     await expect(teacherPage.locator('#students-list')).toContainText('Student (de)');
  101 |   });
  102 |
  103 |   test('should handle student disconnection and reconnection', async () => {
  104 |     // Setup
  105 |     await teacherPage.goto('/teacher');
  106 |     await expect(teacherPage.locator('#status')).toContainText('Registered as teacher', { timeout: 10000 });
  107 |     
  108 |     await studentPage.goto('/student');
  109 |     await studentPage.selectOption('#language-dropdown', 'fr');
  110 |     await studentPage.click('#connect-btn');
  111 |     await expect(studentPage.locator('#connection-status span')).toContainText('Connected', { timeout: 10000 });
  112 |     
  113 |     // Student disconnects
  114 |     await studentPage.click('#connect-btn');
  115 |     await expect(studentPage.locator('#connection-status span')).toContainText('Disconnected');
  116 |
  117 |     // Teacher should see student disconnected (e.g., student removed from list or count decremented)
  118 |     // Depending on implementation, wait for list to update or specific status
  119 |     await expect(teacherPage.locator('#students-list')).not.toContainText('Student (fr)', { timeout: 5000 });
  120 |     await expect(teacherPage.locator('#status')).toContainText('Registered as teacher');
  121 |
  122 |     // Student reconnects
  123 |     await studentPage.click('#connect-btn');
  124 |     await expect(studentPage.locator('#connection-status span')).toContainText('Connected');
  125 |     
  126 |     // Verify teacher shows student reconnected (or still has 1 student)
  127 |     // This might require checking the students list or a specific status message
  128 |     await expect(teacherPage.locator('#students-list')).toContainText('Student (fr)', { timeout: 5000 });
  129 |   });
  130 | });
  131 |
```