# =============================================================================
# AIVoiceTranslator Test Environment Configuration Template
# =============================================================================
# Copy this file to .env.test in the project root for test configuration
# cp config/env.test.example .env.test

# -----------------------------------------------------------------------------
# Test Environment Settings
# -----------------------------------------------------------------------------
NODE_ENV=test
LOG_LEVEL=warn
REALTIME_TRANSPORT=websocket
COMMUNICATION_PROTOCOL=websocket

# Test timing scale for faster test execution
TEST_TIMING_SCALE=0.01

# Database synchronization wait time for tests
TEST_DATABASE_SYNC_WAIT_MS=100

# -----------------------------------------------------------------------------
# Database Configuration (Test Database)
# -----------------------------------------------------------------------------
DATABASE_URL=postgres://your_test_db_url_here

# -----------------------------------------------------------------------------
# API Keys (Use test/mock keys for CI/CD)
# -----------------------------------------------------------------------------
# OpenAI API Key - Use real key for integration tests, mock for unit tests
OPENAI_API_KEY=sk-test-placeholder-for-integration-tests

# ElevenLabs API Key - Use real key for integration tests, mock for unit tests  
ELEVENLABS_API_KEY=test-placeholder-for-integration-tests

# -----------------------------------------------------------------------------
# Service Tier Configuration (Test Defaults)
# -----------------------------------------------------------------------------

# STT (Speech-to-Text) Service Tier - Test Environment
# Default: 'auto' (will use mock services in test environment via WhisperCpp fix)
# Available options:
#   - 'auto'             = Auto-fallback through all tiers (RECOMMENDED FOR TESTS)
#   - 'premium-openai'   = Tier 1a: OpenAI STT (requires OPENAI_API_KEY)
#   - 'premium-labs'     = Tier 1b: ElevenLabs STT (requires ELEVENLABS_API_KEY)
#   - 'free-hq'          = Tier 2: Deepgram Nova-2 (free, high quality)
#   - 'free-enhanced'    = Tier 3: Whisper.cpp + Voice Isolation (local + enhancement)
#   - 'free-basic'       = Tier 4: Whisper.cpp Basic (local processing - MOCKED IN TESTS)
STT_SERVICE_TYPE=auto

# Translation Service Tier - Test Environment
# Default: 'auto' (will use mock/real services based on test type)
# Available options:
#   - 'auto'         = Auto-fallback through all tiers (RECOMMENDED FOR TESTS)
#   - 'premium'      = Tier 1: OpenAI Translation (requires OPENAI_API_KEY)
#   - 'free-hq'      = Tier 2: DeepSeek Translation (free, high quality)
#   - 'free-basic'   = Tier 3: MyMemory Translation (free, basic)
#   - 'offline'      = Tier 4: Offline Translation (no network required)
TRANSLATION_SERVICE_TYPE=auto

# TTS (Text-to-Speech) Service Tier - Test Environment
# Default: 'auto' (will use mock/real services based on test type)
# Available options:
#   - 'auto'             = Auto-fallback through all tiers (RECOMMENDED FOR TESTS)
#   - 'premium-labs'     = Tier 1a: ElevenLabs TTS (requires ELEVENLABS_API_KEY)
#   - 'premium-openai'   = Tier 1b: OpenAI TTS (requires OPENAI_API_KEY)
#   - 'free-hq'          = Tier 2: Local eSpeak-NG (local processing, 41 languages)
#   - 'free-basic'       = Tier 3: Browser TTS (client-side Web Speech API)
#   - 'silent'           = Tier 4: Silent mode (no audio output)
TTS_SERVICE_TYPE=auto
FORCE_TEST_TTS_SERVICE=silent

# -----------------------------------------------------------------------------
# Whisper Configuration (Test Environment)
# -----------------------------------------------------------------------------
# Whisper Model for local processing - Use smallest model for faster tests
WHISPER_MODEL=base

# -----------------------------------------------------------------------------
# Test-Optimized Session Management Configuration
# -----------------------------------------------------------------------------
# Reduced timeouts for faster test execution
SESSION_VERY_SHORT_THRESHOLD_MS=1000
SESSION_STALE_TIMEOUT_MS=10000
SESSION_ALL_STUDENTS_LEFT_TIMEOUT_MS=5000
SESSION_EMPTY_TEACHER_TIMEOUT_MS=5000
SESSION_CLEANUP_INTERVAL_MS=2000
TEACHER_RECONNECTION_GRACE_PERIOD_MS=5000

# Classroom code configuration (shorter for tests)
CLASSROOM_CODE_EXPIRATION_MS=30000
CLASSROOM_CODE_CLEANUP_INTERVAL_MS=5000

# Audio processing configuration (minimal for tests)
MIN_AUDIO_DATA_LENGTH=512
MIN_AUDIO_BUFFER_LENGTH=256

# Message timing configuration (faster for tests)
SESSION_EXPIRED_MESSAGE_DELAY_MS=500
INVALID_CLASSROOM_MESSAGE_DELAY_MS=500

# Health check configuration (faster for tests)
HEALTH_CHECK_INTERVAL_MS=5000

# Logging configuration (shorter previews for tests)
LOG_TEXT_PREVIEW_LENGTH=50

# -----------------------------------------------------------------------------
# Test-Specific Features
# -----------------------------------------------------------------------------
# Enable detailed translation logging for test debugging
ENABLE_DETAILED_TRANSLATION_LOGGING=true

# Test environment detection flags
VITEST=true

# Feature Flags (Test Defaults)
# Enable two-way communication in tests where explicitly needed
FEATURE_TWO_WAY_COMMUNICATION=false
FEATURE_MANUAL_TRANSLATION_CONTROL=true

# Live comprehension indicators default for tests
FEATURE_LIVE_COMPREHENSION_INDICATORS=false

# Low literacy mode default for tests
FEATURE_LOW_LITERACY_MODE=false

# Classroom modes default for tests
FEATURE_CLASSROOM_MODES=false

# Redaction defaults for tests
FEATURE_REDACT_PROFANITY=false
FEATURE_REDACT_PII=false

# ACE master feature flag (can be toggled per-suite)
FEATURE_ACE=0

# Server interim transcription for tests (disabled)
FEATURE_SERVER_INTERIM_TRANSCRIPTION=0

# Gate original teacher-language audio in tests (disabled)
FEATURE_INCLUDE_ORIGINAL_TTS=0
